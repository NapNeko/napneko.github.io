import{_ as g,C as n,o as d,c as u,j as a,a as i,E as e,w as t,b as h,ar as r,aD as p}from"./chunks/framework.BeKdlGsR.js";const P=JSON.parse('{"title":"热重载开发","description":"","frontmatter":{},"headers":[],"relativePath":"develop/plugin/hot-reload.md","filePath":"develop/plugin/hot-reload.md","lastUpdated":1770555617000}'),E={name:"develop/plugin/hot-reload.md"},b={class:"tip custom-block"},C={tabindex:"0"},A={class:"tip custom-block"};function F(y,s,B,m,f,v){const c=n("NolebasePageProperties"),l=n("VPNolebaseInlineLinkPreview"),o=n("Mermaid"),k=n("NolebaseGitChangelog");return d(),u("div",null,[s[19]||(s[19]=a("h1",{id:"热重载开发",tabindex:"-1"},[i("热重载开发 "),a("a",{class:"header-anchor",href:"#热重载开发","aria-label":'Permalink to "热重载开发"'},"​")],-1)),e(c),s[20]||(s[20]=a("p",null,[i("在传统的插件开发流程中，每次修改代码都需要手动构建、复制文件、重启 NapCat，效率较低。NapCat 提供了 "),a("strong",null,"热重载（HMR）"),i(" 机制，允许你在开发过程中修改代码后自动重新加载插件，无需重启 NapCat。")],-1)),a("div",b,[s[5]||(s[5]=a("p",{class:"custom-block-title"},"适用场景",-1)),a("p",null,[s[1]||(s[1]=i("热重载适用于 ",-1)),s[2]||(s[2]=a("strong",null,"本地开发和调试阶段",-1)),s[3]||(s[3]=i("。当你完成开发并准备发布时，仍然使用 ",-1)),e(l,{href:"./publish"},{default:t(()=>[...s[0]||(s[0]=[i("发布插件",-1)])]),_:1}),s[4]||(s[4]=i(" 中的标准流程。",-1))])]),s[21]||(s[21]=a("h2",{id:"架构概览",tabindex:"-1"},[i("架构概览 "),a("a",{class:"header-anchor",href:"#架构概览","aria-label":'Permalink to "架构概览"'},"​")],-1)),s[22]||(s[22]=a("p",null,"热重载机制由三个组件协同工作：",-1)),(d(),h(r,null,{default:t(()=>[e(o,{id:"mermaid-19",class:"mermaid my-class",graph:"flowchart%20LR%0A%20%20%20%20A%5B%22napcat-plugin-debug%3Cbr%2F%3E(NapCat%20%E7%AB%AF%E6%8F%92%E4%BB%B6)%22%5D%20%3C--%3E%7C%22WebSocket%3Cbr%2F%3EJSON-RPC%22%7C%20B%5B%22napcatHmrPlugin%3Cbr%2F%3E(Vite%20%E6%8F%92%E4%BB%B6)%22%5D%0A%0A%20%20%20%20subgraph%20NapCat%20%E7%AB%AF%0A%20%20%20%20%20%20%20%20A%20--%3E%20C%5B%22PluginManager%20API%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%E6%9C%AC%E5%9C%B0%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%0A%20%20%20%20%20%20%20%20V%5B%22Vite%20build%20--watch%22%5D%20--%3E%20B%0A%20%20%20%20%20%20%20%20B%20--%3E%20D%5B%22%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2%22%5D%0A%20%20%20%20%20%20%20%20B%20--%3E%20E%5B%22%E8%87%AA%E5%8A%A8%E9%87%8D%E8%BD%BD%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20style%20A%20fill%3A%23667eea%2Ccolor%3A%23fff%0A%20%20%20%20style%20B%20fill%3A%234CAF50%2Ccolor%3A%23fff%0A%20%20%20%20style%20V%20fill%3A%23bd34fe%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...s[6]||(s[6]=[i(" Loading... ",-1)])]),_:1})),a("table",C,[s[12]||(s[12]=a("thead",null,[a("tr",null,[a("th",null,"组件"),a("th",null,"说明")])],-1)),a("tbody",null,[a("tr",null,[a("td",null,[a("strong",null,[e(l,{href:"https://github.com/NapNeko/napcat-plugin-debug",target:"_blank",rel:"noreferrer"},{default:t(()=>[...s[7]||(s[7]=[i("napcat-plugin-debug",-1)])]),_:1})])]),s[8]||(s[8]=a("td",null,[i("NapCat 端插件，启动 WebSocket 服务器（默认 "),a("code",null,"ws://127.0.0.1:8998"),i("），将 PluginManager 的 API 暴露为 JSON-RPC 接口")],-1))]),s[11]||(s[11]=a("tr",null,[a("td",null,[a("strong",null,"napcatHmrPlugin"),i(" (Vite 插件)")]),a("td",null,[i("集成到 Vite 构建流程中，在每次 "),a("code",null,"writeBundle"),i(" 时自动连接调试服务、复制 dist/ 到远程、调用 reloadPlugin。来自 "),a("code",null,"napcat-plugin-debug-cli/vite")])],-1)),a("tr",null,[a("td",null,[a("strong",null,[e(l,{href:"https://www.npmjs.com/package/napcat-plugin-debug-cli",target:"_blank",rel:"noreferrer"},{default:t(()=>[...s[9]||(s[9]=[i("napcat-plugin-debug-cli",-1)])]),_:1})])]),s[10]||(s[10]=a("td",null,"可选的 CLI 工具，提供交互式 REPL、手动部署等功能",-1))])])]),s[23]||(s[23]=p("",7)),a("div",A,[s[16]||(s[16]=a("p",{class:"custom-block-title"},"TIP",-1)),a("p",null,[s[14]||(s[14]=i("如果你使用 ",-1)),e(l,{href:"https://github.com/NapNeko/napcat-plugin-template",target:"_blank",rel:"noreferrer"},{default:t(()=>[...s[13]||(s[13]=[i("napcat-plugin-template",-1)])]),_:1}),s[15]||(s[15]=i(" 模板，这些依赖和配置已经预置好，无需额外操作。",-1))])]),s[24]||(s[24]=p("",16)),(d(),h(r,null,{default:t(()=>[e(o,{id:"mermaid-224",class:"mermaid my-class",graph:"flowchart%20TD%0A%20%20%20%20A%5B%22vite%20build%22%5D%20--%3E%20B%5B%22Vite%20%E6%9E%84%E5%BB%BA%20%E2%86%92%20%E4%BA%A7%E5%87%BA%20dist%2F%22%5D%0A%20%20%20%20B%20--%3E%20C%5B%22napcatHmrPlugin%3A%20writeBundle%20%E9%92%A9%E5%AD%90%22%5D%0A%20%20%20%20C%20--%3E%20D%5B%22%E8%BF%9E%E6%8E%A5%E8%B0%83%E8%AF%95%E6%9C%8D%E5%8A%A1%20WebSocket%22%5D%0A%20%20%20%20D%20--%3E%20E%5B%22RPC%3A%20getDebugInfo()%22%5D%0A%20%20%20%20E%20--%3E%20F%5B%22%E8%8E%B7%E5%8F%96%E8%BF%9C%E7%A8%8B%E6%8F%92%E4%BB%B6%E7%9B%AE%E5%BD%95%E8%B7%AF%E5%BE%84%22%5D%0A%20%20%20%20F%20--%3E%20G%5B%22%E8%AF%BB%E5%8F%96%20dist%2Fpackage.json%20%E7%9A%84%20name%20%E5%AD%97%E6%AE%B5%22%5D%0A%20%20%20%20G%20--%3E%20H%5B%22%E5%A4%8D%E5%88%B6%20dist%2F%20%E2%86%92%20%E8%BF%9C%E7%A8%8B%E6%8F%92%E4%BB%B6%E7%9B%AE%E5%BD%95%2F%E6%8F%92%E4%BB%B6%E5%90%8D%2F%22%5D%0A%20%20%20%20H%20--%3E%20I%7B%22%E6%8F%92%E4%BB%B6%E6%98%AF%E5%90%A6%E5%B7%B2%E6%B3%A8%E5%86%8C%EF%BC%9F%22%7D%0A%20%20%20%20I%20--%20%E6%98%AF%20--%3E%20J%5B%22RPC%3A%20reloadPlugin(id)%22%5D%0A%20%20%20%20I%20--%20%E5%90%A6%20--%3E%20K%5B%22RPC%3A%20loadDirectoryPlugin(path)%22%5D%0A%20%20%20%20J%20--%3E%20L%5B%22%E9%83%A8%E7%BD%B2%E5%AE%8C%E6%88%90%20%E2%9C%93%22%5D%0A%20%20%20%20K%20--%3E%20L%0A%0A%20%20%20%20style%20A%20fill%3A%23e8f4f8%2Cstroke%3A%232196F3%0A%20%20%20%20style%20C%20fill%3A%23bd34fe%2Ccolor%3A%23fff%0A%20%20%20%20style%20L%20fill%3A%23e8f5e9%2Cstroke%3A%234CAF50%0A"})]),fallback:t(()=>[...s[17]||(s[17]=[i(" Loading... ",-1)])]),_:1})),s[25]||(s[25]=p("",9)),(d(),h(r,null,{default:t(()=>[e(o,{id:"mermaid-283",class:"mermaid my-class",graph:"flowchart%20LR%0A%20%20%20%20A%5B%22%E4%BF%AE%E6%94%B9%E6%BA%90%E7%A0%81%22%5D%20--%3E%20B%5B%22Vite%20watch%3Cbr%2F%3E%E9%87%8D%E6%96%B0%E6%9E%84%E5%BB%BA%20dist%2F%22%5D%0A%20%20%20%20B%20--%3E%20C%5B%22napcatHmrPlugin%3Cbr%2F%3EwriteBundle%20%E9%92%A9%E5%AD%90%22%5D%0A%20%20%20%20C%20--%3E%20D%5B%22WebSocket%3Cbr%2F%3EJSON-RPC%22%5D%0A%20%20%20%20D%20--%3E%20E%5B%22NapCat%3A%3Cbr%2F%3Eplugin_cleanup()%3Cbr%2F%3E%E2%86%93%20%E6%B8%85%E9%99%A4%E6%A8%A1%E5%9D%97%E7%BC%93%E5%AD%98%3Cbr%2F%3E%E2%86%93%20import()%3Cbr%2F%3E%E2%86%93%20plugin_init(ctx)%22%5D%0A%0A%20%20%20%20style%20A%20fill%3A%23fff3e0%2Cstroke%3A%23FF9800%0A%20%20%20%20style%20C%20fill%3A%23bd34fe%2Ccolor%3A%23fff%0A%20%20%20%20style%20E%20fill%3A%23e8f5e9%2Cstroke%3A%234CAF50%0A"})]),fallback:t(()=>[...s[18]||(s[18]=[i(" Loading... ",-1)])]),_:1})),s[26]||(s[26]=p("",25)),e(k)])}const N=g(E,[["render",F]]);export{P as __pageData,N as default};
