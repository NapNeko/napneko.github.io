import{_ as g,C as l,o as h,c as A,j as a,a as i,E as t,aD as p,b as E,w as n,ar as d}from"./chunks/framework.BeKdlGsR.js";const x=JSON.parse('{"title":"插件机制原理","description":"","frontmatter":{},"headers":[],"relativePath":"develop/plugin/mechanism.md","filePath":"develop/plugin/mechanism.md","lastUpdated":1770550472000}'),c={name:"develop/plugin/mechanism.md"},B={class:"tip custom-block"},u={class:"info custom-block"};function y(F,s,C,b,D,f){const r=l("NolebasePageProperties"),k=l("Mermaid"),e=l("VPNolebaseInlineLinkPreview"),o=l("NolebaseGitChangelog");return h(),A("div",null,[s[28]||(s[28]=a("h1",{id:"插件机制原理",tabindex:"-1"},[i("插件机制原理 "),a("a",{class:"header-anchor",href:"#插件机制原理","aria-label":'Permalink to "插件机制原理"'},"​")],-1)),t(r),s[29]||(s[29]=p('<p>在开始开发 NapCat 插件之前，了解插件系统的运作机制有助于更合理地设计和编写插件。</p><h2 id="插件是什么" tabindex="-1">插件是什么？ <a class="header-anchor" href="#插件是什么" aria-label="Permalink to &quot;插件是什么？&quot;">​</a></h2><p>NapCat 插件本质上是一个 <strong>TypeScript/JavaScript 模块</strong>，它被 NapCat 的插件管理器加载后，通过生命周期钩子与 NapCat 主程序进行交互。</p><p>插件的工作方式可以概括为：</p><blockquote><p><strong>NapCat 加载你的插件 → 传给你一个上下文对象 <code>ctx</code> → 你通过 <code>ctx</code> 调用 NapCat 提供的各种能力</strong></p></blockquote><h2 id="核心架构" tabindex="-1">核心架构 <a class="header-anchor" href="#核心架构" aria-label="Permalink to &quot;核心架构&quot;">​</a></h2><p>整个插件系统由三个关键部分组成：</p>',7)),(h(),E(d,null,{default:n(()=>[t(k,{id:"mermaid-28",class:"mermaid my-class",graph:"block-beta%0A%20%20%20%20columns%203%0A%20%20%20%20%0A%20%20%20%20block%3Anapcat%3A3%0A%20%20%20%20%20%20%20%20columns%203%0A%20%20%20%20%20%20%20%20A%5B%22NapCat%20Core%5Cn(QQ%20%E5%BA%95%E5%B1%82)%22%5D%0A%20%20%20%20%20%20%20%20B%5B%22OneBot11%5CnAdapter%22%5D%0A%20%20%20%20%20%20%20%20C%5B%22%E6%8F%92%E4%BB%B6%E7%AE%A1%E7%90%86%E5%99%A8%5Cn(%E5%8A%A0%E8%BD%BD%2F%E5%8D%B8%E8%BD%BD%E6%8F%92%E4%BB%B6)%22%5D%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20space%3A3%0A%20%20%20%20%0A%20%20%20%20block%3Actx%3A3%0A%20%20%20%20%20%20%20%20D%5B%22NapCatPluginContext%5Cn(%E6%8F%92%E4%BB%B6%E4%B8%8A%E4%B8%8B%E6%96%87%E5%AF%B9%E8%B1%A1%20ctx)%22%5D%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20space%3A3%0A%20%20%20%20%0A%20%20%20%20block%3Aplugin%3A3%0A%20%20%20%20%20%20%20%20columns%201%0A%20%20%20%20%20%20%20%20E%5B%22%E4%BD%A0%E7%9A%84%E6%8F%92%E4%BB%B6%22%5D%0A%20%20%20%20%20%20%20%20F%5B%22plugin_init(ctx)%20%E2%86%90%20%E5%88%9D%E5%A7%8B%E5%8C%96%E6%97%B6%E6%94%B6%E5%88%B0%20ctx%5Cnplugin_onmessage(ctx)%20%E2%86%90%20%E6%B6%88%E6%81%AF%E5%88%B0%E6%9D%A5%E6%97%B6%E4%BD%BF%E7%94%A8%20ctx%20%E5%A4%84%E7%90%86%5Cnplugin_onevent(ctx)%20%E2%86%90%20%E4%BA%8B%E4%BB%B6%E5%88%B0%E6%9D%A5%E6%97%B6%E4%BD%BF%E7%94%A8%20ctx%20%E5%A4%84%E7%90%86%5Cnplugin_cleanup(ctx)%20%E2%86%90%20%E5%8D%B8%E8%BD%BD%E6%97%B6%E4%BD%BF%E7%94%A8%20ctx%20%E6%B8%85%E7%90%86%22%5D%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20A%20--%3E%20D%0A%20%20%20%20B%20--%3E%20D%0A%20%20%20%20C%20--%3E%20D%0A%20%20%20%20D%20--%20%22%E4%BC%A0%E9%80%92%E7%BB%99%22%20--%3E%20E%0A%0A%20%20%20%20style%20napcat%20fill%3A%23e8f4f8%2Cstroke%3A%232196F3%0A%20%20%20%20style%20ctx%20fill%3A%23fff3e0%2Cstroke%3A%23FF9800%0A%20%20%20%20style%20plugin%20fill%3A%23e8f5e9%2Cstroke%3A%234CAF50%0A"})]),fallback:n(()=>[...s[0]||(s[0]=[i(" Loading... ",-1)])]),_:1})),s[30]||(s[30]=p(`<h2 id="ctx-能做什么" tabindex="-1">ctx 能做什么？ <a class="header-anchor" href="#ctx-能做什么" aria-label="Permalink to &quot;ctx 能做什么？&quot;">​</a></h2><p><code>ctx</code>（即 <code>NapCatPluginContext</code>）是插件与 NapCat 交互的唯一桥梁。它提供了 <strong>三个层次</strong> 的能力：</p><h3 id="层次一-调用-onebot-action-最常用" tabindex="-1">层次一：调用 OneBot Action（最常用） <a class="header-anchor" href="#层次一-调用-onebot-action-最常用" aria-label="Permalink to &quot;层次一：调用 OneBot Action（最常用）&quot;">​</a></h3><p>通过 <code>ctx.actions.call(...)</code> 调用标准的 OneBot11 协议 Action，这是最主要的使用方式。</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 发送消息</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx.actions.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;send_msg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, params, ctx.adapterName, ctx.pluginManager.config);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 获取群列表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx.actions.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;get_group_list&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ctx.adapterName, ctx.pluginManager.config);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 撤回消息</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx.actions.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;delete_msg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { message_id }, ctx.adapterName, ctx.pluginManager.config);</span></span></code></pre></div><p>这些 Action 就是 NapCat 对外暴露的 OneBot11 API（如 <code>send_msg</code>、<code>get_group_list</code>、<code>set_group_ban</code> 等），与通过 HTTP/WebSocket 调用的 API 完全一致，只是插件内部可以直接调用，无需走网络请求。</p>`,6)),a("div",B,[s[13]||(s[13]=a("p",{class:"custom-block-title"},"API 查阅方式",-1)),a("ul",null,[a("li",null,[s[3]||(s[3]=a("strong",null,"使用 AI 查询",-1)),s[4]||(s[4]=i("：官方插件模板 ",-1)),t(e,{href:"https://github.com/NapNeko/napcat-plugin-template",target:"_blank",rel:"noreferrer"},{default:n(()=>[...s[1]||(s[1]=[i("napcat-plugin-template",-1)])]),_:1}),s[5]||(s[5]=i(" 的 ",-1)),s[6]||(s[6]=a("code",null,".vscode/mcp.json",-1)),s[7]||(s[7]=i(" 中已预配置了 ",-1)),t(e,{href:"https://napcat.apifox.cn/",target:"_blank",rel:"noreferrer"},{default:n(()=>[...s[2]||(s[2]=[i("napcat.apifox.cn",-1)])]),_:1}),s[8]||(s[8]=i(" 的 MCP 服务器。使用 VS Code + GitHub Copilot 打开项目后，可以直接在 Copilot Chat 中用自然语言查询 OneBot 和 NapCat 提供的各种 API 接口。",-1))]),a("li",null,[s[10]||(s[10]=a("strong",null,"手动查阅",-1)),s[11]||(s[11]=i("：也可以直接访问 ",-1)),t(e,{href:"https://napcat.apifox.cn/",target:"_blank",rel:"noreferrer"},{default:n(()=>[...s[9]||(s[9]=[i("https://napcat.apifox.cn/",-1)])]),_:1}),s[12]||(s[12]=i(" 浏览完整的 API 文档。",-1))])])]),s[31]||(s[31]=p(`<h3 id="层次二-使用插件框架能力" tabindex="-1">层次二：使用插件框架能力 <a class="header-anchor" href="#层次二-使用插件框架能力" aria-label="Permalink to &quot;层次二：使用插件框架能力&quot;">​</a></h3><p><code>ctx</code> 还提供了一系列插件框架本身的能力，这些与 OneBot 协议无关：</p><table tabindex="0"><thead><tr><th>能力</th><th>通过</th><th>用途</th></tr></thead><tbody><tr><td>路由注册</td><td><code>ctx.router</code></td><td>注册 HTTP API、静态文件、WebUI 页面</td></tr><tr><td>日志记录</td><td><code>ctx.logger</code></td><td>统一格式的日志输出</td></tr><tr><td>数据存储</td><td><code>ctx.dataPath</code> / <code>ctx.configPath</code></td><td>插件的数据和配置持久化</td></tr><tr><td>配置面板</td><td><code>ctx.NapCatConfig</code></td><td>在 WebUI 生成配置界面</td></tr><tr><td>插件管理</td><td><code>ctx.pluginManager</code></td><td>管理其他插件（查询、启停、加载）</td></tr><tr><td>插件通信</td><td><code>ctx.getPluginExports()</code></td><td>获取其他插件的导出对象，实现插件间交互</td></tr></tbody></table><h3 id="层次三-访问-napcat-底层-高级用法" tabindex="-1">层次三：访问 NapCat 底层（高级用法） <a class="header-anchor" href="#层次三-访问-napcat-底层-高级用法" aria-label="Permalink to &quot;层次三：访问 NapCat 底层（高级用法）&quot;">​</a></h3><p><code>ctx</code> 还暴露了 NapCat 的内部实例，允许执行标准 OneBot 协议之外的操作：</p><ul><li><code>ctx.core</code> — NapCat 底层核心实例</li><li><code>ctx.oneBot</code> — OneBot11 适配器实例</li></ul><div class="warning custom-block"><p class="custom-block-title">注意</p><p>直接使用 <code>ctx.core</code> 和 <code>ctx.oneBot</code> 属于高级用法，这些内部 API 可能在版本升级时发生变化。一般情况下优先使用 <code>ctx.actions.call(...)</code> 来调用标准 OneBot Action。</p></div><h2 id="插件的两种典型用途" tabindex="-1">插件的两种典型用途 <a class="header-anchor" href="#插件的两种典型用途" aria-label="Permalink to &quot;插件的两种典型用途&quot;">​</a></h2><p>根据你要实现的功能，NapCat 插件大致可以分为两种模式（或两者结合）：</p><h3 id="模式一-bot-功能型插件" tabindex="-1">模式一：Bot 功能型插件 <a class="header-anchor" href="#模式一-bot-功能型插件" aria-label="Permalink to &quot;模式一：Bot 功能型插件&quot;">​</a></h3><p>这是最常见的模式。<strong>监听消息/事件 → 调用 OneBot Action 做出响应。</strong></p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 典型流程：收到消息 → 处理 → 调用 OneBot Action 回复</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> plugin_onmessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">event</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (event.raw_message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;ping&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 通过 ctx.actions 调用 OneBot Action 发送消息</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx.actions.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;send_msg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;pong&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            message_type: event.message_type,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            group_id: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(event.group_id),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }, ctx.adapterName, ctx.pluginManager.config);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>适用场景：关键词回复、命令处理、定时任务、消息转发、群管理等。</p><h3 id="模式二-webui-功能型插件" tabindex="-1">模式二：WebUI 功能型插件 <a class="header-anchor" href="#模式二-webui-功能型插件" aria-label="Permalink to &quot;模式二：WebUI 功能型插件&quot;">​</a></h3><p>不处理任何 QQ 消息，<strong>仅通过 <code>ctx.router</code> 注册路由和页面</strong>，在 NapCat 的 WebUI 中提供额外的管理界面或工具。</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> plugin_init</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 注册一个 WebUI 页面</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ctx.router.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">page</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        path: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;dashboard&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        title: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;数据面板&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        htmlFile: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;webui/index.html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 注册 API</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ctx.router.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getNoAuth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/stats&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        res.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ code: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, data: { visits: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>适用场景：数据可视化面板、配置管理工具、系统监控等。</p><h3 id="模式三-两者结合" tabindex="-1">模式三：两者结合 <a class="header-anchor" href="#模式三-两者结合" aria-label="Permalink to &quot;模式三：两者结合&quot;">​</a></h3>`,18)),a("p",null,[s[15]||(s[15]=i("实际开发中，很多插件会 ",-1)),s[16]||(s[16]=a("strong",null,"同时",-1)),s[17]||(s[17]=i(" 使用这两种模式 —— 处理消息的同时提供一个 WebUI 管理界面。官方插件模板 ",-1)),t(e,{href:"https://github.com/NapNeko/napcat-plugin-template",target:"_blank",rel:"noreferrer"},{default:n(()=>[...s[14]||(s[14]=[i("napcat-plugin-template",-1)])]),_:1}),s[18]||(s[18]=i(" 就是这种模式的典型示例。",-1))]),a("div",u,[s[21]||(s[21]=a("p",{class:"custom-block-title"},"关于插件模板",-1)),a("p",null,[t(e,{href:"https://github.com/NapNeko/napcat-plugin-template",target:"_blank",rel:"noreferrer"},{default:n(()=>[...s[19]||(s[19]=[i("napcat-plugin-template",-1)])]),_:1}),s[20]||(s[20]=i(" 会随着 NapCat 项目的更新而持续调整（如 API 变化、最佳实践优化等）。建议开发前以模板仓库的最新版本为准，并关注仓库的 Release 和 README 以了解变更。",-1))])]),s[32]||(s[32]=a("h2",{id:"生命周期概览",tabindex:"-1"},[i("生命周期概览 "),a("a",{class:"header-anchor",href:"#生命周期概览","aria-label":'Permalink to "生命周期概览"'},"​")],-1)),s[33]||(s[33]=a("p",null,"NapCat 通过调用你导出的特定函数来驱动插件运行：",-1)),(h(),E(d,null,{default:n(()=>[t(k,{id:"mermaid-214",class:"mermaid my-class",graph:"flowchart%20TD%0A%20%20%20%20A%5B%22NapCat%20%E5%90%AF%E5%8A%A8%22%5D%20--%3E%20B%5B%22%E6%89%AB%E6%8F%8F%20plugins%20%E7%9B%AE%E5%BD%95%22%5D%0A%20%20%20%20B%20--%3E%20C%5B%22%E5%8A%A0%E8%BD%BD%E6%8F%92%E4%BB%B6%E6%A8%A1%E5%9D%97%22%5D%0A%20%20%20%20C%20--%3E%20D%5B%22%E8%B0%83%E7%94%A8%20plugin_init(ctx)%5Cn%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%9A%E6%B3%A8%E5%86%8C%E8%B7%AF%E7%94%B1%E3%80%81%E5%8A%A0%E8%BD%BD%E9%85%8D%E7%BD%AE%E7%AD%89%22%5D%0A%20%20%20%20D%20--%3E%20E%5B%22%E5%BC%80%E5%A7%8B%E7%9B%91%E5%90%AC%E6%B6%88%E6%81%AF%2F%E4%BA%8B%E4%BB%B6%22%5D%0A%20%20%20%20E%20--%3E%20F%5B%22plugin_onmessage(ctx%2C%20event)%5Cn%E6%B6%88%E6%81%AF%E5%88%B0%E6%9D%A5%22%5D%0A%20%20%20%20E%20--%3E%20G%5B%22plugin_onevent(ctx%2C%20event)%5Cn%E5%85%B6%E4%BB%96%E4%BA%8B%E4%BB%B6%E5%88%B0%E6%9D%A5%22%5D%0A%20%20%20%20F%20--%3E%20E%0A%20%20%20%20G%20--%3E%20E%0A%20%20%20%20D%20--%3E%20H%5B%22%E6%8F%92%E4%BB%B6%E5%8D%B8%E8%BD%BD%2F%E9%87%8D%E8%BD%BD%E6%97%B6%22%5D%0A%20%20%20%20H%20--%3E%20I%5B%22plugin_cleanup(ctx)%5Cn%E6%B8%85%E7%90%86%EF%BC%9A%E9%87%8A%E6%94%BE%E8%B5%84%E6%BA%90%E3%80%81%E5%81%9C%E6%AD%A2%E5%AE%9A%E6%97%B6%E5%99%A8%E7%AD%89%22%5D%0A%0A%20%20%20%20style%20A%20fill%3A%23e8f4f8%2Cstroke%3A%232196F3%0A%20%20%20%20style%20D%20fill%3A%23fff3e0%2Cstroke%3A%23FF9800%0A%20%20%20%20style%20F%20fill%3A%23e8f5e9%2Cstroke%3A%234CAF50%0A%20%20%20%20style%20G%20fill%3A%23e8f5e9%2Cstroke%3A%234CAF50%0A%20%20%20%20style%20I%20fill%3A%23ffebee%2Cstroke%3A%23f44336%0A"})]),fallback:n(()=>[...s[22]||(s[22]=[i(" Loading... ",-1)])]),_:1})),s[34]||(s[34]=p('<h2 id="与外部-onebot-框架的区别" tabindex="-1">与外部 OneBot 框架的区别 <a class="header-anchor" href="#与外部-onebot-框架的区别" aria-label="Permalink to &quot;与外部 OneBot 框架的区别&quot;">​</a></h2><p>既然可以通过 HTTP/WebSocket 调用 OneBot API，为什么还需要插件？以下是两种方式的对比：</p><table tabindex="0"><thead><tr><th>对比项</th><th>外部 OneBot 客户端</th><th>NapCat 插件</th></tr></thead><tbody><tr><td>通信方式</td><td>网络请求 (HTTP/WS)</td><td>直接函数调用</td></tr><tr><td>部署方式</td><td>独立进程/独立服务</td><td>嵌入 NapCat 内部</td></tr><tr><td>性能</td><td>有网络开销</td><td>零网络开销，直接调用</td></tr><tr><td>能力范围</td><td>仅限 OneBot 协议</td><td>OneBot + NapCat 内部 API</td></tr><tr><td>WebUI 集成</td><td>需要独立搭建前端</td><td>直接嵌入 NapCat WebUI</td></tr><tr><td>用户安装</td><td>需要额外配置</td><td>放入 plugins 目录即可</td></tr></tbody></table><p>综上，插件是一种更轻量、集成度更高的开发方式，适用于需要与 NapCat WebUI 联动或对性能有较高要求的场景。</p><h2 id="下一步" tabindex="-1">下一步 <a class="header-anchor" href="#下一步" aria-label="Permalink to &quot;下一步&quot;">​</a></h2>',5)),a("ul",null,[a("li",null,[t(e,{href:"./"},{default:n(()=>[...s[23]||(s[23]=[i("快速开始开发插件",-1)])]),_:1})]),a("li",null,[t(e,{href:"./structure"},{default:n(()=>[...s[24]||(s[24]=[i("项目结构与最佳实践",-1)])]),_:1})]),a("li",null,[t(e,{href:"./hot-reload"},{default:n(()=>[...s[25]||(s[25]=[i("热重载开发",-1)])]),_:1}),s[26]||(s[26]=i(" — 改代码即时生效，提升开发效率",-1))]),a("li",null,[t(e,{href:"./api/doc"},{default:n(()=>[...s[27]||(s[27]=[i("插件 API 参考",-1)])]),_:1})])]),t(o)])}const P=g(c,[["render",y]]);export{x as __pageData,P as default};
