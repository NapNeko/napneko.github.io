import{_ as p,C as i,c as l,o as k,j as a,G as n,ar as e,a as E}from"./chunks/framework.DwOsETNj.js";const C=JSON.parse('{"title":"OneBot ç½‘ç»œåŸºç¡€","description":"","frontmatter":{},"headers":[],"relativePath":"onebot/network.md","filePath":"onebot/network.md","lastUpdated":1745813782000}'),o={name:"onebot/network.md"};function r(d,s,g,y,c,F){const t=i("NolebasePageProperties"),h=i("NolebaseGitChangelog");return k(),l("div",null,[s[0]||(s[0]=a("h1",{id:"onebot-ç½‘ç»œåŸºç¡€",tabindex:"-1"},[E("OneBot ç½‘ç»œåŸºç¡€ "),a("a",{class:"header-anchor",href:"#onebot-ç½‘ç»œåŸºç¡€","aria-label":'Permalink to "OneBot ç½‘ç»œåŸºç¡€"'},"â€‹")],-1)),n(t),s[1]||(s[1]=e(`<p>æœ¬ç« èŠ‚ä»‹ç» NapCatQQ ä¸ OneBot 11 è¿›è¡Œ HTTP å’Œ WebSocket é€šä¿¡çš„åŸºæœ¬æ–¹å¼ã€‚è¯·æ ¹æ® NapCatQQ çš„å®é™…éƒ¨ç½²è§’è‰²é€‰æ‹©åˆé€‚çš„é€šä¿¡æ¨¡å¼ã€‚</p><h2 id="_1-http-é€šä¿¡" tabindex="-1">1. HTTP é€šä¿¡ <a class="header-anchor" href="#_1-http-é€šä¿¡" aria-label="Permalink to &quot;1. HTTP é€šä¿¡&quot;">â€‹</a></h2><p>OneBot 11 çš„ HTTP é€šä¿¡åˆ†ä¸ºä¸¤ç§è§’è‰²ï¼š</p><ul><li><strong>HTTP å®¢æˆ·ç«¯</strong>ï¼šNapCatQQ ä½œä¸ºå®¢æˆ·ç«¯ï¼Œå‘ OneBot 11 çš„ HTTP API ä¸»åŠ¨å‘é€è¯·æ±‚ï¼ˆå¦‚å‘é€æ¶ˆæ¯ï¼‰ã€‚</li><li><strong>HTTP æœåŠ¡å™¨</strong>ï¼šNapCatQQ ä½œä¸ºæœåŠ¡å™¨ï¼Œæ¥æ”¶ OneBot 11 æ¨é€çš„äº‹ä»¶ï¼ˆevent pushï¼‰ã€‚</li></ul><h3 id="_1-1-napcatqq-ä½œä¸º-http-å®¢æˆ·ç«¯å‘é€è¯·æ±‚" tabindex="-1">1.1 NapCatQQ ä½œä¸º HTTP å®¢æˆ·ç«¯å‘é€è¯·æ±‚ <a class="header-anchor" href="#_1-1-napcatqq-ä½œä¸º-http-å®¢æˆ·ç«¯å‘é€è¯·æ±‚" aria-label="Permalink to &quot;1.1 NapCatQQ ä½œä¸º HTTP å®¢æˆ·ç«¯å‘é€è¯·æ±‚&quot;">â€‹</a></h3><p>NapCatQQ å¯ä»¥é€šè¿‡ HTTP POST è¯·æ±‚å‘ OneBot 11 çš„ API åœ°å€å‘é€æŒ‡ä»¤ã€‚</p><p><strong>ç¤ºä¾‹ï¼šå‘é€ç§èŠæ¶ˆæ¯</strong></p><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">POST</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> http://&lt;host&gt;:&lt;port&gt;/send_private_msg</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Content-Type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> application/json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123456789</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ä½ å¥½ï¼ŒNapCatQQï¼&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>è¿”å›ç¤ºä¾‹ï¼š</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ok&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;retcode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;message_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1234</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>ä»£ç æ¼”ç¤ºï¼šPython HTTP å®¢æˆ·ç«¯å‘é€ API è¯·æ±‚</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> requests</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://&lt;host&gt;:&lt;port&gt;/send_private_msg&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">payload </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123456789</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ä½ å¥½ï¼ŒNapCatQQï¼&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">resp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> requests.post(url, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">json</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">payload)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(resp.json())</span></span></code></pre></div><blockquote><p>ğŸ±â€ğŸ’» å°è´´å£«ï¼šåˆ«å¿˜äº†æ›¿æ¢ <code>&lt;host&gt;:&lt;port&gt;</code> ä¸ºå®é™…çš„ OneBot 11 åœ°å€å“¦ï¼å¦‚æœé‡åˆ°è¿æ¥å¤±è´¥ï¼Œè®°å¾—æ£€æŸ¥é˜²ç«å¢™å’Œ API æ˜¯å¦å¼€å¯ã€‚</p></blockquote><hr><h3 id="_1-2-napcatqq-ä½œä¸º-http-æœåŠ¡å™¨æ¥æ”¶äº‹ä»¶" tabindex="-1">1.2 NapCatQQ ä½œä¸º HTTP æœåŠ¡å™¨æ¥æ”¶äº‹ä»¶ <a class="header-anchor" href="#_1-2-napcatqq-ä½œä¸º-http-æœåŠ¡å™¨æ¥æ”¶äº‹ä»¶" aria-label="Permalink to &quot;1.2 NapCatQQ ä½œä¸º HTTP æœåŠ¡å™¨æ¥æ”¶äº‹ä»¶&quot;">â€‹</a></h3><p>è¦æ¥æ”¶äº‹ä»¶ï¼Œéœ€è¦é…ç½® OneBot 11 çš„ HTTP ä¸ŠæŠ¥ï¼ˆevent pushï¼‰ï¼Œå³è®© OneBot 11 å‘ NapCatQQ æŒ‡å®šçš„ HTTP æœåŠ¡å™¨æ¨é€äº‹ä»¶æ•°æ®ã€‚NapCatQQ éœ€è¦å®ç°ä¸€ä¸ª HTTP æœåŠ¡å™¨ï¼Œç›‘å¬ POST è¯·æ±‚ï¼Œè§£ææ”¶åˆ°çš„ JSON æ•°æ®ã€‚</p><p><strong>äº‹ä»¶æ¨é€ç¤ºä¾‹ï¼š</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;post_type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;message_type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;private&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123456789</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ä½ å¥½&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>ä»£ç æ¼”ç¤ºï¼šPython HTTP æœåŠ¡å™¨æ¥æ”¶äº‹ä»¶</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> flask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Flask, request</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Flask(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">__name__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@app.route</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">methods</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;POST&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> receive_event</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    event </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> request.json</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;æ”¶åˆ°äº‹ä»¶ï¼š&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, event)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;OK&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __name__</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;__main__&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    app.run(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8080</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><blockquote><p>ğŸ±â€ğŸ‘“ å°æé†’ï¼šFlask é»˜è®¤ç›‘å¬ 127.0.0.1ï¼Œå¦‚éœ€å¤–éƒ¨è®¿é—®è¯·åŠ  <code>host=&quot;0.0.0.0&quot;</code>ã€‚åˆ«å¿˜äº†å®‰è£… Flaskï¼š<code>pip install flask</code>ï¼</p></blockquote><hr><h2 id="_2-websocket-é€šä¿¡" tabindex="-1">2. WebSocket é€šä¿¡ <a class="header-anchor" href="#_2-websocket-é€šä¿¡" aria-label="Permalink to &quot;2. WebSocket é€šä¿¡&quot;">â€‹</a></h2><p>WebSocket é€šä¿¡åŒæ ·åˆ†ä¸ºä¸¤ç§è§’è‰²ï¼š</p><ul><li><strong>WebSocket å®¢æˆ·ç«¯</strong>ï¼šNapCatQQ ä½œä¸ºå®¢æˆ·ç«¯ï¼Œä¸»åŠ¨è¿æ¥ OneBot 11 çš„ WebSocket æœåŠ¡ç«¯ï¼Œè¿›è¡ŒåŒå‘é€šä¿¡ã€‚</li><li><strong>WebSocket æœåŠ¡å™¨</strong>ï¼šNapCatQQ ä½œä¸ºæœåŠ¡å™¨ï¼ŒOneBot 11 ä½œä¸ºå®¢æˆ·ç«¯ä¸»åŠ¨è¿æ¥ NapCatQQ çš„ WebSocket æœåŠ¡ç«¯ï¼Œæ¨é€äº‹ä»¶å’Œå¤„ç†è¯·æ±‚ã€‚</li></ul><h3 id="_2-1-napcatqq-ä½œä¸º-websocket-å®¢æˆ·ç«¯" tabindex="-1">2.1 NapCatQQ ä½œä¸º WebSocket å®¢æˆ·ç«¯ <a class="header-anchor" href="#_2-1-napcatqq-ä½œä¸º-websocket-å®¢æˆ·ç«¯" aria-label="Permalink to &quot;2.1 NapCatQQ ä½œä¸º WebSocket å®¢æˆ·ç«¯&quot;">â€‹</a></h3><p>NapCatQQ é€šè¿‡ WebSocket è¿æ¥åˆ° OneBot 11 çš„ ws æˆ– wss åœ°å€ã€‚è¿æ¥å»ºç«‹åï¼Œå‘é€ JSON æ ¼å¼çš„äº‹ä»¶å’Œå¤„ç†è¯·æ±‚ã€‚</p><p><strong>å‘é€ç¾¤æ¶ˆæ¯ç¤ºä¾‹ï¼š</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;send_group_msg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;params&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;group_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123456</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;å¤§å®¶å¥½ï¼&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;echo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;è‡ªå®šä¹‰æ ‡è¯†&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>å“åº”ç¤ºä¾‹ï¼š</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ok&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;retcode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;message_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5678</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;echo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;è‡ªå®šä¹‰æ ‡è¯†&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>äº‹ä»¶æ¨é€ç¤ºä¾‹ï¼š</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;post_type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;message_type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;group&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;group_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123456</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">654321</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ä½ å¥½&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>ä»£ç æ¼”ç¤ºï¼šPython WebSocket å®¢æˆ·ç«¯æ¥æ”¶äº‹ä»¶</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> asyncio</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> websockets</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    uri </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ws://&lt;host&gt;:&lt;port&gt;/&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> websockets.connect(uri) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ws:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # å‘é€è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        req </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;send_group_msg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;params&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;group_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123456</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;å¤§å®¶å¥½ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;echo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ws.send(json.dumps(req))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # æ¥æ”¶å“åº”æˆ–äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        while</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            msg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ws.recv()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;æ”¶åˆ°æ¶ˆæ¯ï¼š&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, msg)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">asyncio.run(main())</span></span></code></pre></div><blockquote><p>ğŸ±â€ğŸš€ æ¸©é¦¨æç¤ºï¼šè®°å¾—å®‰è£… websockets åº“ï¼š<code>pip install websockets</code>ã€‚WebSocket åœ°å€è¦å†™å¯¹ï¼Œwss ä»£è¡¨åŠ å¯†è¿æ¥å“¦ï¼</p></blockquote><hr><h3 id="_2-2-napcatqq-ä½œä¸º-websocket-æœåŠ¡å™¨æ¥æ”¶äº‹ä»¶å’Œè¯·æ±‚" tabindex="-1">2.2 NapCatQQ ä½œä¸º WebSocket æœåŠ¡å™¨æ¥æ”¶äº‹ä»¶å’Œè¯·æ±‚ <a class="header-anchor" href="#_2-2-napcatqq-ä½œä¸º-websocket-æœåŠ¡å™¨æ¥æ”¶äº‹ä»¶å’Œè¯·æ±‚" aria-label="Permalink to &quot;2.2 NapCatQQ ä½œä¸º WebSocket æœåŠ¡å™¨æ¥æ”¶äº‹ä»¶å’Œè¯·æ±‚&quot;">â€‹</a></h3><p>NapCatQQ ä¹Ÿå¯ä»¥å®ç° WebSocket æœåŠ¡å™¨ï¼Œè®© OneBot 11 ä½œä¸ºå®¢æˆ·ç«¯ä¸»åŠ¨è¿æ¥ NapCatQQ çš„æœåŠ¡å™¨ã€‚è¿æ¥å»ºç«‹åï¼ŒOneBot 11 ä¼šé€šè¿‡è¯¥è¿æ¥æ¨é€äº‹ä»¶å’Œæ¥æ”¶ NapCatQQ çš„è¯·æ±‚ã€‚NapCatQQ éœ€è¦å¤„ç†æ¥è‡ª OneBot 11 çš„æ¶ˆæ¯ï¼Œå¹¶æ ¹æ®éœ€è¦å‘é€è¯·æ±‚ã€‚</p><p><strong>ä»£ç æ¼”ç¤ºï¼šPython WebSocket æœåŠ¡å™¨æ¥æ”¶äº‹ä»¶å’Œè¯·æ±‚</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> asyncio</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> websockets</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(websocket, path):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> websocket:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;æ”¶åˆ°æ¶ˆæ¯ï¼š&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, message)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # å¯æ ¹æ®éœ€è¦å›å¤æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # await websocket.send(...)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">start_server </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> websockets.serve(handler, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0.0.0.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8765</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">asyncio.get_event_loop().run_until_complete(start_server)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">asyncio.get_event_loop().run_forever()</span></span></code></pre></div><blockquote><p>ğŸ±â€ğŸ å°æŠ€å·§ï¼šæœåŠ¡å™¨ç›‘å¬ <code>0.0.0.0</code> å¯è®©å¤–éƒ¨è®¾å¤‡è®¿é—®ã€‚åˆ«å¿˜äº†ç«¯å£ä¸è¦è¢«å ç”¨ï¼Œå¦åˆ™ä¼šå¯åŠ¨å¤±è´¥ï¼</p></blockquote><hr><h2 id="æ€»ç»“" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h2><ul><li>HTTP æ”¯æŒ NapCatQQ ä½œä¸ºå®¢æˆ·ç«¯ï¼ˆä¸»åŠ¨è¯·æ±‚ï¼‰å’ŒæœåŠ¡å™¨ï¼ˆè¢«åŠ¨æ¥æ”¶äº‹ä»¶ï¼‰ä¸¤ç§æ¨¡å¼ã€‚</li><li>WebSocket æ”¯æŒ NapCatQQ ä½œä¸ºå®¢æˆ·ç«¯ï¼ˆä¸»åŠ¨è¿æ¥ OneBot 11ï¼‰å’ŒæœåŠ¡å™¨ï¼ˆè¢«åŠ¨æ¥æ”¶ OneBot 11 è¿æ¥ï¼‰ä¸¤ç§æ¨¡å¼ï¼Œæ¨èä¼˜å…ˆä½¿ç”¨ WebSocketï¼Œå®æ—¶æ€§æ›´å¥½ã€‚</li></ul><blockquote><p>ğŸ¾ æœ€åæé†’ï¼šæ¥å£å­—æ®µã€ç«¯å£ã€åœ°å€ç­‰éƒ½è¦å’Œå®é™…ç¯å¢ƒå¯¹åº”ï¼Œå°ç²—å¿ƒæ˜¯ä¸è¡Œçš„ï¼</p></blockquote>`,46)),n(h)])}const q=p(o,[["render",r]]);export{C as __pageData,q as default};
